http://railscasts.com/episodes/241-simple-omniauth-revised